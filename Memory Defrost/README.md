# Memory MCP Server

ä¸€ä¸ªé€šç”¨çš„ MCP (Model Context Protocol) è®°å¿†æœåŠ¡ï¼Œä¸ºä»»ä½•æ”¯æŒ MCP åè®®çš„ AI å®¢æˆ·ç«¯æä¾›é•¿æœŸè®°å¿†èƒ½åŠ›ã€‚æ”¯æŒè¯­ä¹‰æœç´¢ã€è®°å¿†åˆ†ç±»å’Œä¼˜å…ˆçº§ç®¡ç†ã€‚

## ç‰¹æ€§

- **è¯­ä¹‰æœç´¢** - ä½¿ç”¨ Gemini gemini-embedding-001ï¼ˆ3072ç»´ï¼Œ100+è¯­è¨€æ”¯æŒï¼Œå…è´¹ï¼‰
- **å¤šè¯­è¨€æœç´¢** - è‡ªåŠ¨ç¿»è¯‘æŸ¥è¯¢è¯ï¼Œæ”¯æŒä¸­è‹±æ—¥è·¨è¯­è¨€æ£€ç´¢
- **è®°å¿†åˆ†ç±»** - 7 ç§é¢„è®¾åˆ†ç±»ï¼Œæ–¹ä¾¿ç»„ç»‡ç®¡ç†
- **ä¼˜å…ˆçº§ç³»ç»Ÿ** - 5 çº§é‡è¦æ€§æ ‡è®°ï¼Œå½±å“æœç´¢æ’åº
- **å†…å­˜ç¼“å­˜** - å¯åŠ¨æ—¶åŠ è½½è®°å¿†åˆ°å†…å­˜ï¼Œæœç´¢æ›´å¿«
- **è‡ªåŠ¨å‡çº§** - æ£€æµ‹æ—§ç‰ˆ embedding å¹¶è‡ªåŠ¨é‡æ–°ç”Ÿæˆ
- **æ¸è¿›å¼æ³¨å…¥** - å¯¹è¯åˆæœŸè¿”å›å°‘é‡è®°å¿†ï¼ŒåæœŸè¿”å›æ›´å¤š
- **åŒç‰ˆæœ¬æ”¯æŒ** - æœ¬åœ° JSON å­˜å‚¨ / äº‘ç«¯ PostgreSQL å­˜å‚¨
- **MCP æ ‡å‡†åè®®** - å…¼å®¹ä»»ä½• MCP å®¢æˆ·ç«¯

## å¯ç”¨å·¥å…·

| å·¥å…· | è¯´æ˜ | è§¦å‘åœºæ™¯ |
|------|------|----------|
| `save_memory` | ä¿å­˜é‡è¦çš„ç”¨æˆ·ä¿¡æ¯ | ç”¨æˆ·æåˆ°é‡è¦ä¸ªäººä¿¡æ¯ã€åå¥½ã€ä¹ æƒ¯ |
| `recall_memory` | æŒ‰å…³é”®è¯/è¯­ä¹‰æ£€ç´¢ç›¸å…³è®°å¿† | ç”¨æˆ·é—®ã€Œä¹‹å‰èŠè¿‡ä»€ä¹ˆã€ã€Œä½ è¿˜è®°å¾—å—ã€ |
| `update_memory` | æ›´æ–°å·²ä¿å­˜çš„è®°å¿† | éœ€è¦ä¿®æ”¹ä¹‹å‰ä¿å­˜çš„ä¿¡æ¯ |
| `list_all_memories` | æŸ¥çœ‹æ‰€æœ‰å·²ä¿å­˜çš„è®°å¿† | ç”¨æˆ·è¦æ±‚åˆ—å‡ºæ‰€æœ‰è®°å¿† |
| `delete_memory` | åˆ é™¤æŒ‡å®šè®°å¿† | ç”¨æˆ·è¦æ±‚å¿˜è®°æŸäº›ä¿¡æ¯ |
| `memory_stats` | æ˜¾ç¤ºè®°å¿†ç»Ÿè®¡ä¿¡æ¯ | æŸ¥çœ‹è®°å¿†æ¦‚è§ˆå’Œåˆ†å¸ƒ |
| `regenerate_embeddings` | é‡æ–°ç”Ÿæˆæ‰€æœ‰è®°å¿†çš„ embedding | åˆ‡æ¢ embedding æ¨¡å‹åä½¿ç”¨ |

## è®°å¿†ä¼˜å…ˆçº§

æ¯æ¡è®°å¿†å¯ä»¥è®¾ç½®ä¼˜å…ˆçº§ï¼ˆ1-5ï¼‰ï¼Œæœç´¢æ—¶é«˜ä¼˜å…ˆçº§è®°å¿†ä¼šè·å¾—åŠ æˆï¼š

| çº§åˆ« | è¯´æ˜ | æ˜¾ç¤º |
|------|------|------|
| 1 | æœ€é«˜ - æ ¸å¿ƒä¸ªäººä¿¡æ¯ | â˜…â˜…â˜… |
| 2 | é«˜ - é‡è¦åå¥½æˆ–ä¹ æƒ¯ | â˜…â˜…â˜† |
| 3 | ä¸­ - ä¸€èˆ¬ä¿¡æ¯ï¼ˆé»˜è®¤ï¼‰ | â˜…â˜†â˜† |
| 4 | ä½ - ä¸´æ—¶æˆ–æ¬¡è¦ä¿¡æ¯ | â˜†â˜†â˜† |
| 5 | æœ€ä½ - å¯èƒ½è¿‡æ—¶çš„ä¿¡æ¯ | Â· |

## è®°å¿†åˆ†ç±»

æ¯æ¡è®°å¿†å¯ä»¥å½’ç±»åˆ°ä»¥ä¸‹åˆ†ç±»ï¼š

- `general` - é€šç”¨ï¼ˆé»˜è®¤ï¼‰
- `preference` - åå¥½è®¾ç½®
- `work` - å·¥ä½œç›¸å…³
- `personal` - ä¸ªäººä¿¡æ¯
- `habit` - ä¹ æƒ¯
- `skill` - æŠ€èƒ½
- `goal` - ç›®æ ‡

## æ¸è¿›å¼æ³¨å…¥

`recall_memory` ä¼šæ ¹æ®ä¼šè¯ä¸­çš„è°ƒç”¨æ¬¡æ•°ï¼Œæ™ºèƒ½è°ƒæ•´è¿”å›çš„è®°å¿†æ•°é‡å’Œç±»å‹ï¼š

| è°ƒç”¨æ¬¡æ•° | è¿”å›å†…å®¹ | ç›®çš„ |
|---------|---------|------|
| ç¬¬ 1 æ¬¡ | æœ€å¤š 3 æ¡æ ¸å¿ƒè®°å¿†ï¼ˆä¼˜å…ˆçº§ 1-2 æˆ– personal åˆ†ç±»ï¼‰ | èº«ä»½ç¡®è®¤ã€å…³ç³»ç¡®è®¤ã€è¯­è¨€é£æ ¼ |
| ç¬¬ 2 æ¬¡ | 1 æ¡æœ€ç›¸å…³è®°å¿† + æç¤ºå‰©ä½™æ•°é‡ | èšç„¦å½“å‰è¯é¢˜ï¼Œæç¤ºå¯æŸ¥çœ‹æ›´å¤š |
| ç¬¬ 3+ æ¬¡ | MAX_RESULTS æ¡ï¼ˆé»˜è®¤ 3ï¼‰ | æ­£å¸¸æœç´¢ï¼Œå®Œæ•´è¿”å› |

> **ä¼šè¯é‡ç½®**ï¼šè¶…è¿‡ 5 åˆ†é’Ÿæœªè°ƒç”¨ `recall_memory`ï¼Œè®¡æ•°å™¨è‡ªåŠ¨å½’é›¶

è¿™ä¸ªè®¾è®¡ç¡®ä¿ï¼š
- å¯¹è¯å¼€å§‹æ—¶å¿«é€Ÿå»ºç«‹ç”¨æˆ·ç”»åƒ
- å¯¹è¯ä¸­æœŸèšç„¦å½“å‰è¯é¢˜
- å¯¹è¯åæœŸæä¾›å®Œæ•´ä¿¡æ¯

## ä¸¤ç§éƒ¨ç½²æ–¹å¼

### 1. æœ¬åœ°ç‰ˆæœ¬ (memory_server.py)

é€‚åˆæœ¬åœ°è¿è¡Œçš„ MCP å®¢æˆ·ç«¯ï¼Œä½¿ç”¨ stdio ä¼ è¾“åè®®ã€‚

- è®°å¿†ä¿å­˜åœ¨æœ¬åœ° `memories.json` æ–‡ä»¶
- ä½¿ç”¨å…³é”®è¯æœç´¢
- æ•°æ®å®Œå…¨æœ¬åœ°åŒ–ï¼Œéšç§ä¿æŠ¤

**è¿è¡Œæ–¹å¼ï¼š**
```bash
python memory_server.py
```

**MCP å®¢æˆ·ç«¯é…ç½®ç¤ºä¾‹ï¼š**
```json
{
  "mcpServers": {
    "memory": {
      "command": "python",
      "args": ["/path/to/memory_server.py"]
    }
  }
}
```

### 2. äº‘ç«¯ç‰ˆæœ¬ (memory_server_http.py)

é€‚åˆè¿œç¨‹è®¿é—®çš„ MCP å®¢æˆ·ç«¯ï¼Œä½¿ç”¨ HTTP/SSE ä¼ è¾“åè®®ã€‚

- ä½¿ç”¨ PostgreSQL æ•°æ®åº“å­˜å‚¨
- é›†æˆ Gemini Embedding API è¿›è¡Œè¯­ä¹‰æœç´¢
- æ”¯æŒå¤šå®¢æˆ·ç«¯è¿æ¥
- **éœ€è¦éƒ¨ç½²åˆ°äº‘å¹³å°**ï¼ˆRailwayã€Renderã€Fly.io ç­‰ï¼‰æˆ–æœ‰å…¬ç½‘ IP çš„æœåŠ¡å™¨

> **ä»€ä¹ˆæ—¶å€™éœ€è¦äº‘ç«¯ç‰ˆæœ¬ï¼Ÿ**
> - ä½¿ç”¨ **Claude.ai ç½‘é¡µç‰ˆ** è¿æ¥ MCP æœåŠ¡æ—¶ï¼ˆéœ€è¦å…¬ç½‘å¯è®¿é—®çš„ URLï¼‰
> - éœ€è¦ä»å¤šå°è®¾å¤‡è®¿é—®åŒä¸€ä»½è®°å¿†æ—¶
> - æœ¬åœ°ç‰ˆæœ¬ä½¿ç”¨ stdio åè®®ï¼Œä»…æ”¯æŒ Claude Desktop ç­‰æœ¬åœ°å®¢æˆ·ç«¯

**è¿è¡Œæ–¹å¼ï¼š**
```bash
# è®¾ç½®ç¯å¢ƒå˜é‡
export DATABASE_URL="postgresql://user:pass@host:5432/dbname"
export GEMINI_API_KEY="your-gemini-api-key"  # å¯é€‰ï¼Œç”¨äºè¯­ä¹‰æœç´¢
export PORT=8000

# å¯é€‰ï¼šè®¾ç½®å·¥å…·å‰ç¼€ï¼ˆç”¨äºè¿è¡Œå¤šä¸ªå®ä¾‹æ—¶é¿å…å·¥å…·åå†²çªï¼‰
export TOOL_PREFIX="work_"      # å·¥å…·åå°†å˜ä¸º work_save_memory, work_recall_memory ç­‰
export SERVER_NAME="work-memory"  # æœåŠ¡å™¨åç§°

python memory_server_http.py
```

### å¤šå®ä¾‹éƒ¨ç½²

å¦‚æœéœ€è¦åŒæ—¶è¿è¡Œå¤šä¸ª Memory MCP å®ä¾‹ï¼ˆä¾‹å¦‚å·¥ä½œè®°å¿†å’Œä¸ªäººè®°å¿†åˆ†å¼€å­˜å‚¨ï¼‰ï¼Œéœ€è¦è®¾ç½®ä¸åŒçš„ `TOOL_PREFIX` é¿å…å·¥å…·åå†²çªï¼š

**å®ä¾‹ 1 - å·¥ä½œè®°å¿†ï¼š**
```bash
export TOOL_PREFIX="work_"
export SERVER_NAME="work-memory"
export DATABASE_URL="postgresql://..."  # å·¥ä½œæ•°æ®åº“
```

**å®ä¾‹ 2 - ä¸ªäººè®°å¿†ï¼š**
```bash
export TOOL_PREFIX="personal_"
export SERVER_NAME="personal-memory"
export DATABASE_URL="postgresql://..."  # ä¸ªäººæ•°æ®åº“
```

è¿™æ ·å·¥å…·åä¼šå˜æˆï¼š
- `work_save_memory`, `work_recall_memory`, ...
- `personal_save_memory`, `personal_recall_memory`, ...

**MCP å®¢æˆ·ç«¯è¿æ¥ï¼š**
- SSE ç«¯ç‚¹: `http://your-server:8000/sse`
- å¥åº·æ£€æŸ¥: `http://your-server:8000/health`

## å®‰è£…

```bash
pip install -r requirements.txt
```

**ä¾èµ–è¯´æ˜ï¼š**
- `mcp` - MCP åè®®åº“
- `starlette`, `uvicorn` - HTTP æœåŠ¡å™¨ï¼ˆäº‘ç«¯ç‰ˆæœ¬ï¼‰
- `psycopg2-binary` - PostgreSQL é©±åŠ¨ï¼ˆäº‘ç«¯ç‰ˆæœ¬ï¼‰
- `numpy` - å‘é‡è®¡ç®—
- `requests` - HTTP å®¢æˆ·ç«¯

## äº‘ç«¯éƒ¨ç½²

### Railway éƒ¨ç½²

1. Fork æ­¤ä»“åº“åˆ°ä½ çš„ GitHub
2. åœ¨ Railway åˆ›å»ºæ–°é¡¹ç›®ï¼Œè¿æ¥ GitHub ä»“åº“
3. æ·»åŠ  PostgreSQL æ•°æ®åº“æœåŠ¡
4. è®¾ç½®ç¯å¢ƒå˜é‡ï¼š
   - `DATABASE_URL` - è‡ªåŠ¨ç”± Railway è®¾ç½®
   - `GEMINI_API_KEY` - ä½ çš„ Gemini API å¯†é’¥ï¼ˆå¯é€‰ï¼‰
5. éƒ¨ç½²å®Œæˆåè·å–æœåŠ¡ URL

### å…¶ä»–äº‘å¹³å°

é¡¹ç›®åŒ…å« `Procfile`ï¼Œå…¼å®¹ Herokuã€Render ç­‰å¹³å°ï¼š
```
web: python memory_server_http.py
```

## ä½¿ç”¨ç¤ºä¾‹

### ä¿å­˜è®°å¿†

```
"è®°ä½æˆ‘å–œæ¬¢ç”¨ TypeScript å†™ä»£ç "
"æˆ‘çš„é¡¹ç›®ç”¨çš„æ˜¯ React + Viteï¼Œè¿™æ˜¯å·¥ä½œç›¸å…³çš„"
"è®°ä½æˆ‘ä¸å–œæ¬¢åœ¨ä»£ç é‡ŒåŠ å¤ªå¤šæ³¨é‡Šï¼Œä¼˜å…ˆçº§è®¾ä¸ºé«˜"
```

### å›å¿†ä¿¡æ¯

```
"æˆ‘ä¹‹å‰å‘Šè¯‰è¿‡ä½ ä»€ä¹ˆç¼–ç¨‹åå¥½ï¼Ÿ"
"ä½ è¿˜è®°å¾—æˆ‘çš„é¡¹ç›®ç”¨ä»€ä¹ˆæŠ€æœ¯æ ˆå—ï¼Ÿ"
"åªåœ¨å·¥ä½œåˆ†ç±»é‡Œæ‰¾ä¸€ä¸‹ç›¸å…³è®°å¿†"
```

### æ›´æ–°è®°å¿†

```
"æŠŠè®°å¿† 3 çš„ä¼˜å…ˆçº§æ”¹æˆæœ€é«˜"
"æ›´æ–°è®°å¿† 5ï¼ŒæŠŠåˆ†ç±»æ”¹æˆ work"
```

### æŸ¥çœ‹ç»Ÿè®¡

```
"æ˜¾ç¤ºè®°å¿†ç»Ÿè®¡"
"åˆ—å‡ºæ‰€æœ‰ work åˆ†ç±»çš„è®°å¿†"
```

## æ•°æ®æ ¼å¼

### æœ¬åœ° JSON æ ¼å¼

```json
[
  {
    "id": 1,
    "content": "ç”¨æˆ·å–œæ¬¢å–å’–å•¡",
    "tags": ["åå¥½", "é¥®é£Ÿ"],
    "priority": 2,
    "category": "preference",
    "created_at": "2024-01-01T12:00:00",
    "updated_at": "2024-01-01T12:00:00"
  }
]
```

### äº‘ç«¯æ•°æ®åº“ Schema

```sql
CREATE TABLE memories (
    id SERIAL PRIMARY KEY,
    content TEXT NOT NULL,
    tags TEXT[] DEFAULT '{}',
    embedding FLOAT8[],
    priority INTEGER DEFAULT 3,
    category VARCHAR(50) DEFAULT 'general',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
)
```

## API ç«¯ç‚¹ï¼ˆäº‘ç«¯ç‰ˆæœ¬ï¼‰

| ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/sse` | GET | MCP SSE è¿æ¥ç«¯ç‚¹ |
| `/messages/` | POST | MCP æ¶ˆæ¯å¤„ç† |
| `/health` | GET | å¥åº·æ£€æŸ¥ |

**å¥åº·æ£€æŸ¥å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "status": "ok",
  "service": "memory-mcp",
  "storage": "postgresql",
  "semantic_search": "enabled"
}
```

## æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MCP Client (ä»»æ„)                      â”‚
â”‚         (Claude Desktop, API Client, Custom App)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ MCP Protocol
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æœ¬åœ°ç‰ˆæœ¬ (stdio)   â”‚      â”‚     äº‘ç«¯ç‰ˆæœ¬ (HTTP/SSE)     â”‚
â”‚  memory_server.py   â”‚      â”‚   memory_server_http.py     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - JSON æ–‡ä»¶å­˜å‚¨      â”‚      â”‚ - PostgreSQL æ•°æ®åº“          â”‚
â”‚ - å…³é”®è¯æœç´¢         â”‚      â”‚ - Gemini Embedding è¯­ä¹‰æœç´¢  â”‚
â”‚ - ä¼˜å…ˆçº§/åˆ†ç±»ç®¡ç†    â”‚      â”‚ - ä¼˜å…ˆçº§/åˆ†ç±»ç®¡ç†             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å…¼å®¹çš„ MCP å®¢æˆ·ç«¯

æœ¬æœåŠ¡å…¼å®¹ä»»ä½•æ”¯æŒ MCP åè®®çš„å®¢æˆ·ç«¯ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š

- Claude Desktop
- è‡ªå®šä¹‰ API å®¢æˆ·ç«¯
- MCP Inspectorï¼ˆè°ƒè¯•å·¥å…·ï¼‰
- å…¶ä»– MCP å…¼å®¹åº”ç”¨

## ä½¿ç”¨å»ºè®®

> **å…³äºå®¢æˆ·ç«¯å†…ç½®è®°å¿†åŠŸèƒ½**
>
> éƒ¨åˆ† MCP å®¢æˆ·ç«¯ï¼ˆå¦‚ Claude Desktopï¼‰è‡ªå¸¦è®°å¿†åŠŸèƒ½ï¼Œå…¶å†…ç½®è®°å¿†çš„æƒé‡é€šå¸¸æ¯”å¤–éƒ¨ MCP æœåŠ¡æ›´é«˜ã€‚
>
> - **å»ºè®®**ï¼šæ ¹æ®è‡ªèº«éœ€æ±‚å†³å®šæ˜¯å¦å…³é—­å®¢æˆ·ç«¯çš„å†…ç½®è®°å¿†åŠŸèƒ½
> - **æ³¨æ„**ï¼šå¦‚æœå…³é—­å®¢æˆ·ç«¯å†…ç½®è®°å¿†ï¼Œæ‰€æœ‰è®°å¿†æ£€ç´¢éƒ½ä¼šèµ°æœ¬æœåŠ¡çš„ `recall_memory`ï¼Œå“åº”æ—¶é—´å¯èƒ½ä¼šç¨é•¿ï¼ˆéœ€è¦è¿›è¡Œè¯­ä¹‰æœç´¢å’Œæ•°æ®åº“æŸ¥è¯¢ï¼‰
>
> è¯·æ ¹æ®å®é™…ä½¿ç”¨åœºæ™¯è‡ªè¡Œæƒè¡¡ã€‚

## æ•…éšœæ’é™¤

### è¯­ä¹‰æœç´¢ä¸å·¥ä½œ

1. æ£€æŸ¥ `GEMINI_API_KEY` ç¯å¢ƒå˜é‡æ˜¯å¦è®¾ç½®
2. æŸ¥çœ‹æœåŠ¡æ—¥å¿—ä¸­çš„ `[EMBEDDING]` ç›¸å…³ä¿¡æ¯
3. å¦‚æœ API å‡ºé”™ï¼Œä¼šè‡ªåŠ¨é™çº§ä¸ºå…³é”®è¯æœç´¢

### æ•°æ®åº“è¿æ¥å¤±è´¥

1. æ£€æŸ¥ `DATABASE_URL` æ ¼å¼æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤æ•°æ®åº“æœåŠ¡æ­£åœ¨è¿è¡Œ
3. æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œé˜²ç«å¢™è®¾ç½®

### SSE è¿æ¥é—®é¢˜

1. ç¡®è®¤å®¢æˆ·ç«¯æ”¯æŒ SSE ä¼ è¾“
2. æ£€æŸ¥ CORS è®¾ç½®ï¼ˆå¦‚æœæ˜¯è·¨åŸŸè®¿é—®ï¼‰
3. ç¡®è®¤ç«¯å£æ²¡æœ‰è¢«å ç”¨

## è‡ªå®šä¹‰ Embedding æœåŠ¡

æœ¬é¡¹ç›®é»˜è®¤ä½¿ç”¨ Google Gemini Embedding APIï¼ˆå…è´¹ï¼‰ï¼Œä½†ä½ å¯ä»¥æ›¿æ¢ä¸ºå…¶ä»– embedding æœåŠ¡ã€‚

### å½“å‰é»˜è®¤è¡Œä¸º

- **æœ‰ GEMINI_API_KEY**: ä½¿ç”¨ Gemini `gemini-embedding-001` æ¨¡å‹è¿›è¡Œè¯­ä¹‰æœç´¢
  - 3072 ç»´å‘é‡ï¼Œç²¾åº¦æ›´é«˜
  - æ”¯æŒ 100+ è¯­è¨€ï¼Œè·¨è¯­è¨€æ£€ç´¢æ•ˆæœæ›´å¥½
  - å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æµ‹æ—§ç‰ˆ embedding (768ç»´) å¹¶å‡çº§
- **æ—  GEMINI_API_KEY**: è‡ªåŠ¨é™çº§ä¸ºå…³é”®è¯æœç´¢ï¼ˆä»ç„¶å¯ç”¨ï¼‰

### æ›¿æ¢ä¸ºå…¶ä»– Embedding æœåŠ¡

å¦‚æœä½ æƒ³ä½¿ç”¨ OpenAIã€Cohereã€æœ¬åœ°æ¨¡å‹ç­‰å…¶ä»– embedding æœåŠ¡ï¼Œéœ€è¦ä¿®æ”¹ `memory_server_http.py` ä¸­çš„ `get_embedding()` å‡½æ•°ï¼š

```python
def get_embedding(text: str) -> list[float] | None:
    """è·å–æ–‡æœ¬çš„ embedding å‘é‡"""
    # æ›¿æ¢ä¸ºä½ çš„ embedding API è°ƒç”¨
    # è¿”å›å€¼åº”ä¸º float åˆ—è¡¨ï¼Œå¦‚ [0.1, 0.2, ...]
    # è¿”å› None è¡¨ç¤ºå¤±è´¥ï¼Œä¼šé™çº§ä¸ºå…³é”®è¯æœç´¢
    pass
```

**å¸¸è§æ›¿ä»£æ–¹æ¡ˆï¼š**
- OpenAI `text-embedding-3-small`
- Cohere `embed-multilingual-v3.0`
- æœ¬åœ°éƒ¨ç½²çš„ sentence-transformers
- å…¶ä»–æ”¯æŒä¸­æ–‡çš„ embedding æ¨¡å‹

## åç»­ä¼˜åŒ–æ–¹å‘

- [x] è¯­ä¹‰æœç´¢ï¼ˆGemini Embeddingï¼‰
- [x] å¤šè¯­è¨€æœç´¢ï¼ˆä¸­è‹±æ—¥è·¨è¯­è¨€æ£€ç´¢ï¼‰
- [x] è®°å¿†ä¼˜å…ˆçº§
- [x] è®°å¿†åˆ†ç±»ç®¡ç†
- [x] è®°å¿†æ›´æ–°åŠŸèƒ½
- [x] è®°å¿†ç»Ÿè®¡åŠŸèƒ½
- [x] Embedding è‡ªåŠ¨å‡çº§
- [ ] è®°å¿†è¿‡æœŸæœºåˆ¶
- [ ] è®°å¿†å¯¼å‡º/å¯¼å…¥
- [ ] è®°å¿†å…³è”åŠŸèƒ½
- [ ] WebSocket ä¼ è¾“æ”¯æŒ

## License

MIT

---

<p align="center">
  <sub>Built with ğŸŒ€ <a href="https://github.com/anthropics/claude-code">Claude Code</a></sub>
</p>
